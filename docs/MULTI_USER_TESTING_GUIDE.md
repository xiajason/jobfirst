# 👥 JobFirst 多人协同测试环境指南

## 🎯 **测试环境概述**

### 当前状态
- **服务器**: 腾讯云 (101.33.251.158)
- **部署状态**: ✅ 基础服务已部署
- **访问状态**: 🔄 需要完善服务启动
- **协同状态**: 📋 需要配置访问权限

## 📋 **访问条件清单**

### 1. **网络访问要求**
- ✅ 服务器IP: `101.33.251.158`
- ✅ 开放端口: 8000, 8210, 3306, 6379
- 🔄 防火墙配置（如需要）
- 🔄 域名配置（推荐）

### 2. **用户权限要求**
- 🔄 测试用户账号
- 🔄 API访问密钥
- 🔄 数据库访问权限
- 🔄 监控访问权限

### 3. **技术环境要求**
- ✅ 网络连通性
- 🔄 健康检查端点
- 🔄 认证系统
- 🔄 日志系统

## 🚀 **立即行动方案**

### 阶段1: 完善服务启动（1-2小时）

#### 1.1 检查服务状态
```bash
# 检查Docker容器状态
ssh root@101.33.251.158 "docker ps"

# 检查服务日志
ssh root@101.33.251.158 "docker logs jobfirst-gateway"
ssh root@101.33.251.158 "docker logs jobfirst-shared-infra"

# 检查端口监听
ssh root@101.33.251.158 "netstat -tlnp | grep -E '8000|8210'"
```

#### 1.2 启动健康检查端点
- 确保API网关有 `/health` 端点
- 确保共享基础设施有 `/health` 端点
- 配置基本的响应内容

#### 1.3 验证服务可用性
```bash
# 测试API网关
curl http://101.33.251.158:8000/health
curl http://101.33.251.158:8000/api/v1/status

# 测试共享基础设施
curl http://101.33.251.158:8210/health
curl http://101.33.251.158:8210/api/v1/status
```

### 阶段2: 配置多人访问（2-4小时）

#### 2.1 创建测试用户账号
```sql
-- 在MySQL中创建测试用户
CREATE USER 'test_user'@'%' IDENTIFIED BY 'test_password';
GRANT SELECT, INSERT, UPDATE, DELETE ON jobfirst_advanced.* TO 'test_user'@'%';
FLUSH PRIVILEGES;
```

#### 2.2 配置API访问密钥
- 生成JWT密钥
- 创建测试用户Token
- 配置API认证中间件

#### 2.3 设置监控和日志
- 配置Prometheus监控
- 设置Grafana仪表板
- 配置日志聚合

### 阶段3: 建立协同工作流程（1天）

#### 3.1 测试环境管理
- 环境状态监控
- 自动部署流程
- 回滚机制

#### 3.2 用户权限管理
- 角色定义
- 权限分配
- 访问控制

#### 3.3 测试数据管理
- 测试数据准备
- 数据隔离
- 数据清理

## 👥 **多人协同测试配置**

### 1. **测试用户角色定义**

| 角色 | 权限 | 职责 |
|------|------|------|
| **管理员** | 全部权限 | 环境管理、用户管理 |
| **开发人员** | 读写权限 | 功能开发、API测试 |
| **测试人员** | 只读权限 | 功能测试、性能测试 |
| **产品经理** | 只读权限 | 功能验证、用户体验 |

### 2. **访问方式配置**

#### 2.1 Web界面访问
```
管理后台: http://101.33.251.158:8000/admin
API文档: http://101.33.251.158:8000/docs
监控面板: http://101.33.251.158:3000 (Grafana)
```

#### 2.2 API访问
```bash
# 获取访问Token
curl -X POST http://101.33.251.158:8000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"test_user","password":"test_password"}'

# 使用Token访问API
curl -H "Authorization: Bearer <token>" \
  http://101.33.251.158:8000/api/v1/users
```

#### 2.3 数据库访问
```bash
# 直接连接数据库
mysql -h 101.33.251.158 -P 3306 -u test_user -p jobfirst_advanced

# 使用Redis
redis-cli -h 101.33.251.158 -p 6379
```

### 3. **测试环境管理**

#### 3.1 环境状态监控
```bash
# 检查服务状态
./scripts/verify-deployment.sh

# 查看实时日志
ssh root@101.33.251.158 "docker-compose logs -f"

# 监控资源使用
ssh root@101.33.251.158 "docker stats"
```

#### 3.2 用户管理
```bash
# 添加新用户
curl -X POST http://101.33.251.158:8000/api/v1/users \
  -H "Authorization: Bearer <admin_token>" \
  -H "Content-Type: application/json" \
  -d '{"username":"new_user","email":"user@example.com","role":"developer"}'

# 重置用户密码
curl -X PUT http://101.33.251.158:8000/api/v1/users/reset-password \
  -H "Authorization: Bearer <admin_token>" \
  -H "Content-Type: application/json" \
  -d '{"user_id":123,"new_password":"new_password"}'
```

## 📊 **测试计划和流程**

### 1. **功能测试**
- API接口测试
- 数据库操作测试
- 缓存功能测试
- 用户认证测试

### 2. **性能测试**
- 并发用户测试
- 响应时间测试
- 资源使用测试
- 压力测试

### 3. **集成测试**
- 前后端集成测试
- 数据库集成测试
- 第三方服务集成测试

### 4. **用户体验测试**
- 界面友好性测试
- 操作流程测试
- 错误处理测试

## 🔧 **技术配置清单**

### 1. **服务配置**
- [ ] API网关健康检查端点
- [ ] 共享基础设施健康检查端点
- [ ] 数据库连接池配置
- [ ] Redis连接配置
- [ ] 日志级别配置

### 2. **安全配置**
- [ ] JWT密钥配置
- [ ] CORS策略配置
- [ ] 防火墙规则配置
- [ ] SSL证书配置（可选）

### 3. **监控配置**
- [ ] Prometheus监控配置
- [ ] Grafana仪表板配置
- [ ] 告警规则配置
- [ ] 日志聚合配置

## 📞 **支持和维护**

### 1. **技术支持**
- 环境问题: 查看Docker日志
- 网络问题: 检查防火墙配置
- 性能问题: 查看监控面板
- 权限问题: 联系管理员

### 2. **维护流程**
- 定期备份数据
- 监控服务状态
- 更新安全补丁
- 优化性能配置

## 🎯 **下一步行动**

### 立即执行（今天）
1. **完善服务启动**
   - 检查Docker容器状态
   - 启动健康检查端点
   - 验证服务可用性

2. **配置基础访问**
   - 创建测试用户
   - 配置API认证
   - 设置监控面板

### 短期目标（本周）
1. **建立协同流程**
   - 用户权限管理
   - 测试数据管理
   - 环境监控配置

2. **开始功能测试**
   - API接口测试
   - 数据库操作测试
   - 用户认证测试

### 中期目标（本月）
1. **完善测试环境**
   - 性能测试配置
   - 自动化测试
   - 持续集成测试

2. **生产环境准备**
   - 安全加固
   - 负载均衡
   - 灾难恢复

---

**准备状态**: 🔄 需要完善服务启动  
**预计完成时间**: 1-2天  
**下一步**: 立即检查服务状态并完善健康检查端点
