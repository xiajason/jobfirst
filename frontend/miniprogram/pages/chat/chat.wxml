<!--chat.wxml-->
<view class="container">
  <!-- èŠå¤©åˆ—è¡¨ -->
  <view class="chat-list" wx:if="{{chatList.length > 0}}">
    <view 
      class="chat-item" 
      wx:for="{{chatList}}" 
      wx:key="id"
      bindtap="navigateToChatDetail"
      data-chat="{{item}}"
    >
      <view class="chat-avatar">
        <image 
          class="avatar" 
          src="{{item.avatar}}" 
          mode="aspectFill"
        />
        <view class="online-status" wx:if="{{item.isOnline}}"></view>
      </view>
      
      <view class="chat-content">
        <view class="chat-header">
          <view class="chat-name">{{item.name}}</view>
          <view class="chat-time">{{item.lastTime}}</view>
        </view>
        
        <view class="chat-message">
          <view class="message-preview">{{item.lastMessage}}</view>
          <view class="message-badge" wx:if="{{item.unreadCount > 0}}">
            <text class="badge">{{item.unreadCount > 99 ? '99+' : item.unreadCount}}</text>
          </view>
        </view>
        
        <view class="chat-meta">
          <view class="chat-company">{{item.company}}</view>
          <view class="chat-position">{{item.position}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:if="{{chatList.length === 0 && !loading}}">
    <view class="empty-icon">ğŸ’¬</view>
    <view class="empty-text">æš‚æ— èŠå¤©è®°å½•</view>
    <view class="empty-desc">æŠ•é€’ç®€å†åå³å¯ä¸HRè¿›è¡Œæ²Ÿé€š</view>
    <button class="btn btn-primary" bindtap="navigateToJobs">å»æŠ•é€’ç®€å†</button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="quick-actions" wx:if="{{chatList.length > 0}}">
    <view class="action-item" bindtap="showFilterModal">
      <view class="action-icon">ğŸ”</view>
      <text class="action-text">ç­›é€‰</text>
    </view>
    <view class="action-item" bindtap="markAllRead">
      <view class="action-icon">âœ“</view>
      <text class="action-text">å…¨éƒ¨å·²è¯»</text>
    </view>
    <view class="action-item" bindtap="clearHistory">
      <view class="action-icon">ğŸ—‘ï¸</view>
      <text class="action-text">æ¸…ç©ºè®°å½•</text>
    </view>
  </view>
</view>

<!-- ç­›é€‰å¼¹çª— -->
<view class="filter-modal" wx:if="{{showFilter}}" bindtap="hideFilterModal">
  <view class="filter-content" catchtap="stopPropagation">
    <view class="filter-header">
      <text class="filter-title">ç­›é€‰èŠå¤©</text>
      <view class="filter-close" bindtap="hideFilterModal">âœ•</view>
    </view>
    
    <view class="filter-options">
      <view class="filter-option">
        <text class="option-label">æœªè¯»æ¶ˆæ¯</text>
        <switch checked="{{filter.unread}}" bindchange="toggleUnreadFilter" />
      </view>
      
      <view class="filter-option">
        <text class="option-label">åœ¨çº¿çŠ¶æ€</text>
        <switch checked="{{filter.online}}" bindchange="toggleOnlineFilter" />
      </view>
      
      <view class="filter-option">
        <text class="option-label">æœ€è¿‘æ´»è·ƒ</text>
        <picker 
          mode="selector" 
          range="{{timeOptions}}" 
          value="{{filter.timeIndex}}"
          bindchange="onTimeFilterChange"
        >
          <view class="picker-value">{{timeOptions[filter.timeIndex]}}</view>
        </picker>
      </view>
    </view>
    
    <view class="filter-actions">
      <button class="btn btn-secondary" bindtap="resetFilter">é‡ç½®</button>
      <button class="btn btn-primary" bindtap="applyFilter">ç¡®å®š</button>
    </view>
  </view>
</view>
