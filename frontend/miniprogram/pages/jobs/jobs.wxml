<!--jobs.wxml-->
<view class="container">
  <!-- 筛选器 -->
  <view class="filter-section">
    <view class="filter-tabs">
      <view 
        class="filter-tab {{currentFilter === 'all' ? 'active' : ''}}" 
        bindtap="setFilter" 
        data-type="all"
      >
        全部
      </view>
      <view 
        class="filter-tab {{currentFilter === 'recommend' ? 'active' : ''}}" 
        bindtap="setFilter" 
        data-type="recommend"
      >
        推荐
      </view>
      <view 
        class="filter-tab {{currentFilter === 'nearby' ? 'active' : ''}}" 
        bindtap="setFilter" 
        data-type="nearby"
      >
        附近
      </view>
      <view 
        class="filter-tab {{currentFilter === 'latest' ? 'active' : ''}}" 
        bindtap="setFilter" 
        data-type="latest"
      >
        最新
      </view>
    </view>
    
    <view class="filter-options">
      <view class="filter-option" bindtap="showLocationPicker">
        <text class="filter-label">📍 {{selectedLocation || '地点'}}</text>
        <icon type="arrow" size="12" color="#999"></icon>
      </view>
      <view class="filter-option" bindtap="showSalaryPicker">
        <text class="filter-label">💰 {{selectedSalary || '薪资'}}</text>
        <icon type="arrow" size="12" color="#999"></icon>
      </view>
      <view class="filter-option" bindtap="showExperiencePicker">
        <text class="filter-label">💼 {{selectedExperience || '经验'}}</text>
        <icon type="arrow" size="12" color="#999"></icon>
      </view>
    </view>
  </view>

  <!-- 搜索框 -->
  <view class="search-section">
    <view class="search-box">
      <view class="search-input-wrapper">
        <icon type="search" size="16" color="#999"></icon>
        <input 
          class="search-input" 
          placeholder="搜索职位、公司、技能" 
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
          bindconfirm="onSearch"
        />
      </view>
    </view>
  </view>

  <!-- 职位列表 -->
  <view class="job-list" wx:if="{{jobs.length > 0}}">
    <view 
      class="job-item card" 
      wx:for="{{jobs}}" 
      wx:key="id"
      bindtap="navigateToJobDetail"
      data-job="{{item}}"
    >
      <view class="job-header">
        <view class="job-title">{{item.title}}</view>
        <view class="job-salary text-primary">{{item.salary}}</view>
      </view>
      
      <view class="job-company">{{item.company}}</view>
      
      <view class="job-tags">
        <text class="tag tag-primary" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
      </view>
      
      <view class="job-meta">
        <text class="job-location">📍 {{item.location}}</text>
        <text class="job-experience">💼 {{item.experience}}</text>
        <text class="job-education">🎓 {{item.education}}</text>
      </view>
      
      <view class="job-footer">
        <view class="job-time">{{item.publishTime}}</view>
        <view class="job-actions">
          <button 
            class="btn btn-secondary btn-sm" 
            catchtap="toggleFavorite" 
            data-job="{{item}}"
          >
            {{item.isFavorite ? '❤️' : '🤍'}}
          </button>
          <button 
            class="btn btn-primary btn-sm" 
            catchtap="applyJob" 
            data-job="{{item}}"
          >
            立即投递
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-container" wx:if="{{jobs.length === 0 && !loading}}">
    <view class="empty-icon">🔍</view>
    <view class="empty-text">暂无相关职位</view>
    <view class="empty-desc">试试调整筛选条件或搜索其他关键词</view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-text">加载中...</view>
  </view>

  <!-- 加载更多 -->
  <view class="load-more" wx:if="{{hasMore && !loading}}">
    <button class="btn btn-secondary" bindtap="loadMore">加载更多</button>
  </view>
</view>

<!-- 地点选择器 -->
<picker 
  mode="region" 
  bindchange="onLocationChange" 
  wx:if="{{showLocationPicker}}"
>
  <view class="picker-placeholder">选择地点</view>
</picker>

<!-- 薪资选择器 -->
<picker 
  mode="selector" 
  range="{{salaryOptions}}" 
  bindchange="onSalaryChange"
  wx:if="{{showSalaryPicker}}"
>
  <view class="picker-placeholder">选择薪资</view>
</picker>

<!-- 经验选择器 -->
<picker 
  mode="selector" 
  range="{{experienceOptions}}" 
  bindchange="onExperienceChange"
  wx:if="{{showExperiencePicker}}"
>
  <view class="picker-placeholder">选择经验</view>
</picker>
